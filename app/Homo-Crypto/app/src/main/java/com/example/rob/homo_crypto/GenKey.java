package com.example.rob.homo_crypto;

import android.support.v7.app.ActionBarActivity;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

import java.math.BigInteger;
import java.util.*;


public class GenKey extends ActionBarActivity {
static String pk;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_gen_key);
        final TextView textView_key = (TextView)findViewById(R.id.textView_key);
        Button gen_key = (Button)findViewById(R.id.key);

        pk = "8\n" +
                "5\n" +
                "8\n" +
                "5\n" +
                "3\n" +
                "Prime p: 72329087714596847789954350208857820208313452378059836336391868817576198562775125600326630423663251605957967008611835269373091539179025907863881749502705710695129831822660983734335739581279576905727829055385707018370477140493945998468864683145019102934844204289291160047191563481625557920171758287204781011723883473593566766085765300533287235597558079818190631637183337766204619939372766374598111733322781075480163673295089491177672295967287763540407227898619911001240856929091690509251529929139710628043608172460518880950208820134941626314907223778729231354308501738917973958890954833591553889833813437214592198601281068495171386327783076475468613321221195323587323839262257125784556397434583254451265317302617853790183038142856946860758269992830642147903734121703048093028665424334169181269931189582155831102425958864686353254495231723060233083410371428789883439397733575280408391594742778019023337461455157742960663776803889EOL1\n" +
                "Alpha a: 21697274702721752694236451782273970294355835411833873444802892733015920693379146635197476362284598276756577070200652243020688254514376098535284709557797799551929680885523116920273349886732227349780912887147780081547274192217186855358011278795115558242224870763887907282884968215879412344305791870332521336048878256261882783002937968530422066001785331513554761358277027077425990735383989254168887754818928397778136168988374323087870547646415126817814333592516527911677077287337650826595242159381881917751366136066402888426870223309998408214431512007197240662289641407542580983689378203116673096030134721597436432758503999667042636946673253435139558831344742548980460312180553107755702692924884104082899550594468991845564003339918797185084138611554684318597549622018885732974035878363210621235005391191218872165364075385175285291351177938223510979903802002980676683516275027589991461196966448005037028337771186814817732633387541EOL2\n" +
                "\n" +
                "\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123496\n" +
                "48138721777141847209816094575149913292765060892320884405747408792199071132877420188102207358730275927279724592384605840850545888888016409153546081935807160356628091881104899122922422988438215330563832403887170251855239542523719226104391033762234992824371610381136992978159449328000939707492265048325512023303660195044230537890699013126290829847695551907236261600724457283501537391283861215559272534373114338156736004860682219799314707920229303906345168431870693195540382402662770839965786197523854536852880379056050020011481858854552639575647984695272233865818579755651114720356849257908507467790431909437847294974622993185043562789094680298855453507491289987702112333509727150667828774410385941487564918639051103897199599140033446026189648709763614248278524839914789994626529166645472050387826159824570736469401418860673747052477576371319363976053043081506682075413875555415222696816154991275785253856354644304584661020331045\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123496\n" +
                "41223547632137447257926498306360254600860029680717767698018869775695489367884804024731617681186711389831401603907438977708968407319637488745443633261038092257163268906842548894181607967739836545786090501401692886315485948789503362542634547255482372801769227158644204419459343458367586014485663021555506120718504609604039868901616824556433316724418631316174971411937150085770788891136446094457719800470786784496175194755691349706651873089707260484854004533528967990780842566459033763362170809079359733465389274527297689866034935104064083807046696519380358187197753025415100930463358734323107663280756400362634100638084566094113006322560368362341838972864744159878138181374625834994972612547236319688921713545391375119536259977775534803829257585037098183323953121167760627512371481294854231146204939134231270674791338047708022126223414075651058177926036832130992810540644696324268887861592072956118302351324973170156742640974693\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123497\n" +
                "-72329087714596847789954350208857820208313452378059836336391868817576198562775125600326630423663251605957967008611835269373091539179025907863881749502705710695129831822660983734335739581279576905727829055385707018370477140493945998468864683145019102934844204289291160047191563481625557920171758287204781011723883473593566766085765300533287235597558079818190631637183337766204619939372766374598111733322781075480163673295089491177672295967287763540407227898619911001240856929091690509251529929139710628043608172460518880950208820134941626314907223778729231354308501738917973958890954833591553889833813437214592198601281068495171386327783076475468613321221195323587323839262257125784556397434583254451265317302617853790183038142856946860758269992830642147903734121703048093028665424334169181269931189582155831102425958864686353254495231723060233083410371428789883439397733575280408391594742778019023337461455157742960663776803889\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123497\n" +
                "-72329087714596847789954350208857820208313452378059836336391868817576198562775125600326630423663251605957967008611835269373091539179025907863881749502705710695129831822660983734335739581279576905727829055385707018370477140493945998468864683145019102934844204289291160047191563481625557920171758287204781011723883473593566766085765300533287235597558079818190631637183337766204619939372766374598111733322781075480163673295089491177672295967287763540407227898619911001240856929091690509251529929139710628043608172460518880950208820134941626314907223778729231354308501738917973958890954833591553889833813437214592198601281068495171386327783076475468613321221195323587323839262257125784556397434583254451265317302617853790183038142856946860758269992830642147903734121703048093028665424334169181269931189582155831102425958864686353254495231723060233083410371428789883439397733575280408391594742778019023337461455157742960663776803889\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123497\n" +
                "68020466278519724163692725199556606138662975086919483475923857453120966127940788114791517967133003221781819606941566047938141531840517044657150462426687468124844158435323179406413077186462886038554866638963209511550346919026270481620745175721394252332113293620878464539547589052489271786351501490098528684294663368492540437217324569243213809492924959127489268220411294396419865209060901931318544092069315020143616607807875836956927888995984099119586293267481067558053338763093962966280066549462965665908863584870440530706482308728679441025844840792245841425549031605627345205428896243852356125699418989372125740827913521050394674302519629776772357150992300339032886759030520709490918295967402424152155464855507475382059818692239212018491322326404167271907766271841694517422113590136305136992533152996405482311749809524867157141869933121500251370583170131591497524362867524436567136791520316866452057501874852475618961314202245\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123497\n" +
                "68817557378217687487047860853910827054422926953051679581518916199852942496420900764081599728780553116181097858026953403785841744802088782412261733322789800693938404930690733236475794945350586120753817987614159274882716686683072198552641204171092917200045058676278276238379488662607780167039062294253847633847056854008064272484200895691174076058318249103188124564834108112736132591156256555175504484101140939886901750518461674551669408056943498813542459441133654516705224749461116393921447259001025013052269882659851502469594475466705799469054992134622188315301045473216517061143526170162665741346578299438808137810874486375474970198846620567634525680799981040376165424168330509983390320981986413568250826201012411727156817030068670467306569842571144053758293167797437254169503014295761716247591142281709377015979047975724071938309274971997903124746288094674128189438308161394863375726209970710690215856576446167687860889756354\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123497\n" +
                "7820151772456283929168114364248207223541002716148509615340963982178488501188562321780143151412946873953016552255151367329036738267627856849275881863479670798657624551562319442379000266619559763274767235191463411115643363307218646038941271859521568292828119836617538841704623529490462989185351210233989151095154667732643352035769844960856841049146092869286383324151662072389114522815669007603438635990361560049536015579003301251219469255470778830719686150718350126501179268191581306951888614001571287673908847397794065027162344272315889064270804711080156992053338904863681656941957540602727157876786798795178135235403224995900218294491944657773101002507326708743807143605981107980690087617619613541397060404877374722064279686891413382182915316474646368215482746948335912674681992900689727285207140703049947106523833650139391615752005684080230415552036889482419818078380972312701416830398324176988993669018418646269572462416082\n" +
                "30318131049039711943809123077632446093557909785365875430664226177420949324531640247866424649913258848452037508479867195292731710825161749395809391558013454998986206458721363677992116943689572106969850524296106295559012574354950888670411106304798282835835736723245268801047046015150351119844044728686554413494908012253771502138513547713295905892582160682535896481157472395534235051561328510433490735814006999710533270068685114791532631868144441927397781805184919951982887537552774977917965149517931182220156626661787600292989833146210636886925396851868253696201582823620454416770487404837760352127906157093357143355109521486708666494728758048748943624511387781586337449794916433427238930124823221317928000824599825447876010859987390302294350463616428350889931225233253986702704289451045065694658803852353328802481493273550393136032883079824164628274914217008328443079306752679322791986663337089406305733935701421718730154123496\n" +
                "-7190113342482740308093797692259996109343641488329122406823865230210888987478782055226926159612683924283361001751423132455959808979423087726386468244251854821987532622374621919545982253899457800808939046580475931215410902688941054295395262518026335684153056212919479812602806890742164246602367254863009232195550779015089090073329178742476347444828557379459553922407442985959339096047337195602826533046679405204326459502099995149171610250501626510637681304338332349968786576800499630366342712507502079752617631025616550396358898219369004325455199868650878902155188780586912470421170367087708355239995621424128434552569622249942901091440070356628462458118009200086771160732095375360406372170935494895698986042054065618383072393526898195323927070581835672586955008269877840154746150045503204882484566839598298678257776451147332041489790600622736231658481742297227030763561489253031913781174446676788818365850320113301196562998263";


    gen_key.setOnClickListener(new View.OnClickListener(){

            public void onClick(View view){
                    textView_key.setText(pk);

                  /*

                    Method to extract the prime p and integer alpha from the pk
                   */

                //extractA(pk);

               //Random value used to obtain the secret key

                Random random = new Random();
                int rand=random.nextInt(20)+4;

                //Big integer use fore alpha
               BigInteger alpha = new BigInteger( extractA(pk));
                Toast.makeText(getApplicationContext(),alpha.toString(),Toast.LENGTH_LONG).show();
                //Big integer use for prime p
                BigInteger p = new BigInteger( extractP(pk));
                Toast.makeText(getApplicationContext(),p.toString(),Toast.LENGTH_LONG).show();



            }
        });




    }
    //extract prime p from the pk
    public String extractP(String str){
        int start = str.indexOf("Prime");
        int end = str.indexOf("EOL1");

        String p = str.substring((start+9),end);
        return p;
    }

    //extract alpha from the pk
    public String extractA(String str){
        int start = str.indexOf("Alpha");
        int end = str.indexOf("EOL2");
        //Toast.makeText(getApplicationContext(),Integer.toString(start),Toast.LENGTH_LONG).show();
        //Toast.makeText(getApplicationContext(),Integer.toString(end),Toast.LENGTH_LONG).show();
        String alpha = str.substring((start+9),end);
        return alpha;
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.menu_gen_key, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        // Handle action bar item clicks here. The action bar will
        // automatically handle clicks on the Home/Up button, so long
        // as you specify a parent activity in AndroidManifest.xml.
        int id = item.getItemId();

        //noinspection SimplifiableIfStatement
        if (id == R.id.action_settings) {
            return true;
        }

        return super.onOptionsItemSelected(item);
    }
}
